---
title: "一句话和6位PIN转换成强密码"
author: "wurong"
date: "2025-08-19 18:43:53"
categories: "密码生成"
tags: [hash]
---

``` python
import argparse
import hashlib

# 固定字符集
LOWER = "abcdefghijklmnopqrstuvwxyz"
UPPER = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
DIGIT = "0123456789"
SYMB  = "@"
POOL  = LOWER + UPPER + DIGIT + SYMB

def phrase_to_password(phrase: str, pin: str, length: int = 10, rounds: int = 100_000) -> str:
    if length < 4:
        raise ValueError("length 至少为 4（需要覆盖四类字符）。")
    if not (pin.isdigit() and len(pin) == 6):
        raise ValueError("PIN 必须是 6 位数字。")

    # 派生足够多的字节
    dklen = max(length, 64)
    dk = hashlib.pbkdf2_hmac(
        "sha256",
        phrase.encode("utf-8"),
        pin.encode("utf-8"),  # 使用 6 位 PIN 作为 salt
        rounds,
        dklen=dklen
    )

    # 确保四类字符各一个
    picks = [
        LOWER[dk[0] % len(LOWER)],
        UPPER[dk[1] % len(UPPER)],
        DIGIT[dk[2] % len(DIGIT)],
        SYMB [dk[3] % len(SYMB )],
    ]

    # 剩余位置从全集补齐
    for i in range(4, length):
        picks.append(POOL[dk[i % len(dk)] % len(POOL)])

    # 洗牌
    j = 0
    for i in range(length - 1, 0, -1):
        j = (j + 1) % len(dk)
        k = dk[j] % (i + 1)
        picks[i], picks[k] = picks[k], picks[i]

    return "".join(picks)

def main():
    parser = argparse.ArgumentParser(description="把一句话 + 6位PIN 转换成强密码")
    parser.add_argument("phrase", help="输入的句子")
    parser.add_argument("pin", help="6位数字 PIN 作为 salt")
    parser.add_argument("--length", type=int, default=10, help="密码长度，默认10")
    args = parser.parse_args()

    pwd = phrase_to_password(args.phrase, args.pin, args.length)
    print(pwd)

if __name__ == "__main__":
    main()

```

## 如何运行脚本
保存成 genpwd.py

``` bash
python3 genpwd.py 我就记住这句话就能得到我的密码 123456
```

## 脚本说明

这个脚本是一个密码生成器，用于将输入的句子和一个 6 位的 PIN 转换为强密码。具体参数可以自己瞎几把修改。
我是把这句话藏的很深写在卡片上了，pin自己想。我只要记住这个密码打开我的其他加密文件都在里面复制粘贴

脚本在github，那句话在任意位置，pin可能是之前不注意安全已经泄露的pin，或者自己想。
所以最关键的那句话一定要自己保管好。写下来。